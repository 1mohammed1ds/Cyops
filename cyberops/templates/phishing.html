{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-lg-8 mx-auto">
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <h4 class="card-title">Phishing Detector</h4>
        <p class="text-muted">Enter a URL or email snippet. CyberOpsHub applies heuristic checks and a lightweight ML model to estimate risk.</p>
        <form method="POST">
          <div class="mb-3">
            <label for="indicator" class="form-label">URL or email content</label>
            <textarea class="form-control" id="indicator" name="indicator" rows="3" placeholder="https://secure-login.example.com/update" required>{{ request.form.get('indicator', '') }}</textarea>
          </div>
          <button class="btn btn-primary" type="submit">Analyse</button>
        </form>
      </div>
    </div>

    {% if result %}
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center flex-wrap">
            <h5 class="card-title mb-0">Classification</h5>
            <span class="badge severity-{{ result.label }}">{{ result.label|title }}</span>
          </div>
          <p class="mt-3 mb-1"><strong>Indicator:</strong> {{ result.indicator }}</p>
          <p class="mb-3"><strong>ML Confidence:</strong> {{ result.score }}%</p>

          <h6>Feature breakdown</h6>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">Domain: {{ result.features.domain }}</li>
            <li class="list-group-item">Length: {{ result.features.url_len }} characters</li>
            <li class="list-group-item">Dots: {{ result.features.dots }} | Hyphen: {{ result.features.hyphen }}</li>
            <li class="list-group-item">HTTPS Prefix: {{ 'Yes' if result.features.https else 'No' }}</li>
            <li class="list-group-item">Suspicious Words: {{ 'Yes' if result.features.suspicious_words else 'No' }}</li>
          </ul>
        </div>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
